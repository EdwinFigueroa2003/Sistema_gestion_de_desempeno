{% extends "layout.html" %}

{% block title %}
Resultado de Análisis Organizacional
{% endblock %}

{% block content %}

<h1>Gestión del Desempeño</h1>
<hr>

<body>
    <h1>Reporte de Análisis Organizacional</h1>
    
    {% if reporte %}
    <!-- Botones para filtrar por dimensión -->
    <div class="dimension-buttons">
        {% for dimension in reporte|groupby('dimension') %}
        <button onclick="filterByDimension('{{ dimension.grouper }}')">{{ dimension.grouper }}</button>
        {% endfor %}
    </div>

    <table>
        <thead>
            <tr>
                <th>Dimensión</th>
                <th>Pregunta</th>
                <th>Respuesta</th>
                <th>Semaforización</th>
            </tr>
        </thead>
        <tbody>
            {% for item in reporte %}
            <tr class="dimension-row" data-dimension="{{ item.dimension }}">
                <td>{{ item.dimension }}</td>
                <td>{{ item.pregunta }}</td>
                <td>{{ item.respuesta }}</td>
                <td>
                    <div class="semaforo">
                        <div class="luz rojo {% if item.semaforizacion == 3 %}encendido{% endif %}"></div>
                        <div class="luz amarillo {% if item.semaforizacion == 2 %}encendido{% endif %}"></div>
                        <div class="luz verde {% if item.semaforizacion == 1 %}encendido{% endif %}"></div>
                    </div>

                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}
    
</body>

<div class="btn">
    <a href="/reportes" class="volver1">VOLVER</a>
</div>

<img src="{{ url_for('static', filename='img/mariposa0.png')}}" class="mariposa" />
<img src="{{ url_for('static', filename='img/organizacion0.png')}}" class="usuarios" />

<style>
    .dimension-buttons button {
        margin-top: 50px;
    }
</style>

<script>
    function filterByDimension(dimension) {
        const rows = document.querySelectorAll('.dimension-row');
        rows.forEach(row => {
            if (row.dataset.dimension === dimension || dimension === 'all') {
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        });
    }
</script>

{% endblock %}